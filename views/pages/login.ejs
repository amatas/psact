<% include ../modules/head %>
<script>
function login()
{
	if($('#loginname').val() == '') alert('Please enter a username');
	else if($('#loginpass').val() == '') alert('Please enter a password');
	else
	{
		if($('#loginrememberme').prop('checked'))
		{
			Cookies.set('id', $('#loginname').val(), 24);
			Cookies.set('pass', $('#loginpass').val(), 24);
		}
		else
		{
			Cookies.set('id', $('#loginname').val());
			Cookies.set('pass', $('#loginpass').val());
		}
		
		$.post('/usercheck', {}, function(data)
		{
			if(data.status == true)
			{
				window.location.replace('/home');
			}
			else
			{
				alert('Invalid login');
			}
		});
	}
};
function create()
{
	if($('#createname').val() == '') alert('Please enter a username');
	//else if($('#createpass').val() == '') alert('Please enter a password');
	else
	{
		Cookies.set('id', $('#createid').val());
		Cookies.set('name', $('#createname').val());
		$.post('/registeruser', {}, function(data)
		{
			if(data.status > 0)
			{
				window.location.replace('/home');
			}
			else if(data.status == 0) alert('Username taken');
			else alert('Error, please reload the page');
		});
	}
};
function swaptocreate()
{
	$("#LOGIN").slideUp("slow");
	$("#CREATE").slideDown("slow");
};
function swaptologin()
{
	$("#CREATE").slideUp("slow");
	$("#LOGIN").slideDown("slow");
};
if(Cookies.get('id')!=''&&Cookies.get('pass')!='') window.location.replace('/home');
</script>
<br/>
<div id="LOGIN">
<h1>Login to PSACT</h1>
<input id="loginname" type="text" placeholder="Username" onkeypress="onEnter(event, login);"></input><br/>
<input id="loginpass" type="password" placeholder="Password" onkeypress="onEnter(event, login);"></input><br/>
<input id="loginrememberme" type="checkbox">Remember me</input><br/>
<button onclick="login()">Login</button>
<button onclick="swaptocreate()">Create new account</button>
</div>
<div id="CREATE" style="display:none">
<h1>Create new PSACT account</h1>
<input id="createid" type="text" placeholder="Email" onkeypress="onEnter(event, create);"></input><br/>
<input id="createname" type="text" placeholder="Name/Handle" onkeypress="onEnter(event, create);"></input><br/>
<button onclick="create()">Create account</button>
<button onclick="swaptologin()">Return to login</button>
</div>

<% include ../modules/footer %>
<script src="/script/ejs"></script>
</body>
</html>